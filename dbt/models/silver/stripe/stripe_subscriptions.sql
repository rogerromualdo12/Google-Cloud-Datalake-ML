WITH source AS (
    SELECT * FROM {{ source('sni_stripe', 'subscriptions') }}
),

renamed AS (
    SELECT
        id,
        object,
        application,
        application_fee_percent,
        automatic_tax_enabled,
        billing_thresholds,
        cancel_at_period_end,
        canceled_at,
        collection_method,
        currency,
        customer,
        days_until_due,
        default_payment_method,
        default_source,
        default_tax_rates,
        description,
        discount,
        items_object,
        items_data_0_id,
        items_data_0_object,
        items_data_0_billing_thresholds,
        items_data_0_metadata,
        items_data_0_plan_id,
        items_data_0_plan_object,
        items_data_0_plan_active,
        items_data_0_plan_aggregate_usage,
        items_data_0_plan_amount,
        items_data_0_plan_amount_decimal,
        items_data_0_plan_billing_scheme,
        items_data_0_plan_created,
        items_data_0_plan_currency,
        items_data_0_plan_interval,
        items_data_0_plan_interval_count,
        items_data_0_plan_livemode,
        items_data_0_plan_metadata_itemcode,
        items_data_0_plan_metadata_taxcode,
        items_data_0_plan_metadata_netsuite_service_sale_item_id,
        items_data_0_plan_metadata_netsuite_service_sale_item_link,
        items_data_0_plan_nickname,
        items_data_0_plan_product,
        items_data_0_plan_tiers_mode,
        items_data_0_plan_transform_usage,
        items_data_0_plan_trial_period_days,
        items_data_0_plan_usage_type,
        items_data_0_price_id,
        items_data_0_price_object,
        items_data_0_price_active,
        items_data_0_price_billing_scheme,
        items_data_0_price_created,
        items_data_0_price_currency,
        items_data_0_price_custom_unit_amount,
        items_data_0_price_livemode,
        items_data_0_price_lookup_key,
        items_data_0_price_metadata_itemcode,
        items_data_0_price_metadata_taxcode,
        items_data_0_price_metadata_netsuite_service_sale_item_id,
        items_data_0_price_metadata_netsuite_service_sale_item_link,
        items_data_0_price_nickname,
        items_data_0_price_product,
        items_data_0_price_recurring_aggregate_usage,
        items_data_0_price_recurring_interval,
        items_data_0_price_recurring_interval_count,
        items_data_0_price_recurring_trial_period_days,
        items_data_0_price_recurring_usage_type,
        items_data_0_price_tax_behavior,
        items_data_0_price_tiers_mode,
        items_data_0_price_transform_quantity,
        items_data_0_price_type,
        items_data_0_price_unit_amount,
        items_data_0_price_unit_amount_decimal,
        items_data_0_quantity,
        items_data_0_subscription,
        items_data_0_tax_rates,
        items_has_more,
        items_total_count,
        items_url,
        latest_invoice,
        livemode,
        metadata,
        next_pending_invoice_item_invoice,
        on_behalf_of,
        pause_collection,
        payment_settings_payment_method_options,
        payment_settings_payment_method_types,
        payment_settings_save_default_payment_method,
        pending_invoice_item_interval,
        pending_setup_intent,
        pending_update,
        plan_id,
        plan_object,
        plan_active,
        plan_aggregate_usage,
        plan_amount,
        plan_amount_decimal,
        plan_billing_scheme,
        plan_created,
        plan_currency,
        plan_interval,
        plan_interval_count,
        plan_livemode,
        plan_metadata_itemcode,
        plan_metadata_taxcode,
        plan_metadata_netsuite_service_sale_item_id,
        plan_metadata_netsuite_service_sale_item_link,
        plan_nickname,
        plan_product,
        plan_tiers_mode,
        plan_transform_usage,
        plan_trial_period_days,
        plan_usage_type,
        quantity,
        schedule,
        start_date,
        status,
        test_clock,
        transfer_data,
        items_data_1_id,
        items_data_1_object,
        items_data_1_billing_thresholds,
        items_data_1_created,
        items_data_1_metadata,
        items_data_1_plan_id,
        items_data_1_plan_object,
        items_data_1_plan_active,
        items_data_1_plan_aggregate_usage,
        items_data_1_plan_amount,
        items_data_1_plan_amount_decimal,
        items_data_1_plan_billing_scheme,
        items_data_1_plan_created,
        items_data_1_plan_currency,
        items_data_1_plan_interval,
        items_data_1_plan_interval_count,
        items_data_1_plan_livemode,
        items_data_1_plan_metadata_itemcode,
        items_data_1_plan_metadata_taxcode,
        items_data_1_plan_metadata_netsuite_service_sale_item_id,
        items_data_1_plan_metadata_netsuite_service_sale_item_link,
        items_data_1_plan_nickname,
        items_data_1_plan_product,
        items_data_1_plan_tiers_mode,
        items_data_1_plan_transform_usage,
        items_data_1_plan_trial_period_days,
        items_data_1_plan_usage_type,
        items_data_1_price_id,
        items_data_1_price_object,
        items_data_1_price_active,
        items_data_1_price_billing_scheme,
        items_data_1_price_created,
        items_data_1_price_currency,
        items_data_1_price_custom_unit_amount,
        items_data_1_price_livemode,
        items_data_1_price_lookup_key,
        items_data_1_price_metadata_itemcode,
        items_data_1_price_metadata_taxcode,
        items_data_1_price_metadata_netsuite_service_sale_item_id,
        items_data_1_price_metadata_netsuite_service_sale_item_link,
        items_data_1_price_nickname,
        items_data_1_price_product,
        items_data_1_price_recurring_aggregate_usage,
        items_data_1_price_recurring_interval,
        items_data_1_price_recurring_interval_count,
        items_data_1_price_recurring_trial_period_days,
        items_data_1_price_recurring_usage_type,
        items_data_1_price_tax_behavior,
        items_data_1_price_tiers_mode,
        items_data_1_price_transform_quantity,
        items_data_1_price_type,
        items_data_1_price_unit_amount,
        items_data_1_price_unit_amount_decimal,
        items_data_1_quantity,
        items_data_1_subscription,
        items_data_1_tax_rates,
        plan,
        metadata_migrated_at,
        items_data_2_id,
        items_data_2_object,
        items_data_2_billing_thresholds,
        items_data_2_created,
        items_data_2_metadata,
        items_data_2_plan_id,
        items_data_2_plan_object,
        items_data_2_plan_active,
        items_data_2_plan_aggregate_usage,
        items_data_2_plan_amount,
        items_data_2_plan_amount_decimal,
        items_data_2_plan_billing_scheme,
        items_data_2_plan_created,
        items_data_2_plan_currency,
        items_data_2_plan_interval,
        items_data_2_plan_interval_count,
        items_data_2_plan_livemode,
        items_data_2_plan_metadata_itemcode,
        items_data_2_plan_metadata_taxcode,
        items_data_2_plan_metadata_netsuite_service_sale_item_id,
        items_data_2_plan_metadata_netsuite_service_sale_item_link,
        items_data_2_plan_nickname,
        items_data_2_plan_product,
        items_data_2_plan_tiers_mode,
        items_data_2_plan_transform_usage,
        items_data_2_plan_trial_period_days,
        items_data_2_plan_usage_type,
        items_data_2_price_id,
        items_data_2_price_object,
        items_data_2_price_active,
        items_data_2_price_billing_scheme,
        items_data_2_price_created,
        items_data_2_price_currency,
        items_data_2_price_custom_unit_amount,
        items_data_2_price_livemode,
        items_data_2_price_lookup_key,
        items_data_2_price_metadata_itemcode,
        items_data_2_price_metadata_taxcode,
        items_data_2_price_metadata_netsuite_service_sale_item_id,
        items_data_2_price_metadata_netsuite_service_sale_item_link,
        items_data_2_price_nickname,
        items_data_2_price_product,
        items_data_2_price_recurring_aggregate_usage,
        items_data_2_price_recurring_interval,
        items_data_2_price_recurring_interval_count,
        items_data_2_price_recurring_trial_period_days,
        items_data_2_price_recurring_usage_type,
        items_data_2_price_tax_behavior,
        items_data_2_price_tiers_mode,
        items_data_2_price_transform_quantity,
        items_data_2_price_type,
        items_data_2_price_unit_amount,
        items_data_2_price_unit_amount_decimal,
        items_data_2_quantity,
        items_data_2_subscription,
        items_data_2_tax_rates,
        items_data_1_plan_metadata_nickname,
        items_data_1_price_metadata_nickname,
        billing_thresholds_amount_gte,
        billing_thresholds_reset_billing_cycle_anchor,
        metadata_org_id,
        metadata_sf_id,
        items_data_1_metadata_created_at,
        items_data_1_metadata_developer_pack,
        items_data_0_metadata_sf_id,
        items_data_0_metadata_created_at,
        items_data_0_metadata_developer_pack,
        metadata_legacy_promo_code,
        items_data_0_tax_rates_0_id,
        items_data_0_tax_rates_0_object,
        items_data_0_tax_rates_0_active,
        items_data_0_tax_rates_0_country,
        items_data_0_tax_rates_0_created,
        items_data_0_tax_rates_0_description,
        items_data_0_tax_rates_0_display_name,
        items_data_0_tax_rates_0_inclusive,
        items_data_0_tax_rates_0_jurisdiction,
        items_data_0_tax_rates_0_livemode,
        items_data_0_tax_rates_0_metadata,
        items_data_0_tax_rates_0_percentage,
        items_data_0_tax_rates_0_state,
        items_data_0_tax_rates_0_tax_type,
        discount_id,
        discount_object,
        discount_checkout_session,
        discount_coupon_id,
        discount_coupon_object,
        discount_coupon_amount_off,
        discount_coupon_created,
        discount_coupon_currency,
        discount_coupon_duration,
        discount_coupon_duration_in_months,
        discount_coupon_livemode,
        discount_coupon_max_redemptions,
        discount_coupon_metadata_netsuite_discount_item_id,
        discount_coupon_metadata_netsuite_discount_item_link,
        discount_coupon_name,
        discount_coupon_percent_off,
        discount_coupon_redeem_by,
        discount_coupon_times_redeemed,
        discount_coupon_valid,
        discount_customer,
        discount_end,
        discount_invoice,
        discount_invoice_item,
        discount_promotion_code,
        discount_start,
        discount_subscription,
        items_data_1_metadata_data_block,
        items_data_0_metadata_data_block,
        payment_settings_payment_method_types_0,
        items_data_2_plan_metadata_nickname,
        items_data_2_price_metadata_nickname,
        items_data_2_metadata_data_block,
        items_data_1_tax_rates_0_id,
        items_data_1_tax_rates_0_object,
        items_data_1_tax_rates_0_active,
        items_data_1_tax_rates_0_country,
        items_data_1_tax_rates_0_created,
        items_data_1_tax_rates_0_description,
        items_data_1_tax_rates_0_display_name,
        items_data_1_tax_rates_0_inclusive,
        items_data_1_tax_rates_0_jurisdiction,
        items_data_1_tax_rates_0_livemode,
        items_data_1_tax_rates_0_metadata,
        items_data_1_tax_rates_0_percentage,
        items_data_1_tax_rates_0_state,
        items_data_1_tax_rates_0_tax_type,
        items_data_2_metadata_created_at,
        items_data_2_tax_rates_0_id,
        items_data_2_tax_rates_0_object,
        items_data_2_tax_rates_0_active,
        items_data_2_tax_rates_0_country,
        items_data_2_tax_rates_0_created,
        items_data_2_tax_rates_0_description,
        items_data_2_tax_rates_0_display_name,
        items_data_2_tax_rates_0_inclusive,
        items_data_2_tax_rates_0_jurisdiction,
        items_data_2_tax_rates_0_livemode,
        items_data_2_tax_rates_0_metadata,
        items_data_2_tax_rates_0_percentage,
        items_data_2_tax_rates_0_state,
        items_data_2_tax_rates_0_tax_type,
        pause_collection_behavior,
        pause_collection_resumes_at,
        default_tax_rates_0_id,
        default_tax_rates_0_object,
        default_tax_rates_0_active,
        default_tax_rates_0_country,
        default_tax_rates_0_created,
        default_tax_rates_0_description,
        default_tax_rates_0_display_name,
        default_tax_rates_0_inclusive,
        default_tax_rates_0_jurisdiction,
        default_tax_rates_0_livemode,
        default_tax_rates_0_metadata,
        default_tax_rates_0_percentage,
        default_tax_rates_0_state,
        default_tax_rates_0_tax_type,
        items_data_2_metadata_developer_pack,
        timestamp_seconds(cast(items_data_0_created AS int)) AS items_data_0_created,
        timestamp_seconds(cast(trial_end AS int)) AS trial_end,
        timestamp_seconds(cast(trial_start AS int)) AS trial_start,
        timestamp_seconds(cast(billing_cycle_anchor AS int)) AS billing_cycle_anchor,
        timestamp_seconds(cast(cancel_at AS int)) AS cancel_at,
        timestamp_seconds(cast(created AS int)) AS created,
        timestamp_seconds(cast(current_period_end AS int)) AS current_period_end,
        timestamp_seconds(cast(current_period_start AS int)) AS current_period_start,
        timestamp_seconds(cast(ended_at AS int)) AS ended_at

    FROM source
)

SELECT * FROM renamed
